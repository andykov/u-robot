!function(e){var t={modules:e.ymaps.modules};!function(e){if(void 0===e&&"function"==typeof require)e=require("ym");e.define("util.providePackage",["system.mergeImports"],function(e,r){e(function(e,t){var n=t[0],o=Array.prototype.slice.call(t,1);n(r.joinImports(e.name,{},e.deps,o))})})}(t.modules),t.modules.define("PieChartClusterer",["Clusterer","util.defineClass","util.extend","PieChartClusterer.icon.params","PieChartClusterer.component.Canvas"],function(e,t,n,s,a,o){var c=n(function(e){c.superclass.constructor.call(this,e),this._canvas=new o(a.icons.large.size),this._canvas.options.setParent(this.options)},t,{createCluster:function(e,t){var n=c.superclass.createCluster.call(this,e,t),o=t.reduce(function(e,t){var n=t.options.get("iconColor","lightBlue");return e[n]=++e[n]||1,e},{}),r=this._canvas.generateIconDataURL(o,t.length),i={clusterIcons:[s({href:r},a.icons.small),s({href:r},a.icons.medium),s({href:r},a.icons.large)],clusterNumbers:a.numbers};return n.options.set(i),n}});e(c)}),t.modules.define("PieChartClustererLayout",["templateLayoutFactory","util.extend","PieChartClusterer.icon.params","PieChartClusterer.component.Canvas"],function(e,t,n,g,y){var m=/#(.+?)(?=Icon|DotIcon|StretchyIcon|CircleIcon|CircleDotIcon)/,C=t.createClass(['<ymaps style="'+["font:10pt arial,sans-serif","position:absolute","display:block","text-align:center","background-repeat:no-repeat","background-position:center"].join(";")+'">',"</ymaps>"].join(""),{build:function(){C.superclass.build.call(this);var e=this.getData().features||this.getData().properties.get("geoObjects"),t=this.getParentElement().firstChild.firstChild,n=new y(g.icons.large.size);n.options.setParent(this.options);var o=e.reduce(function(e,t){var n=t.options.preset||"function"==typeof t.options.get&&t.options.get("preset")||"islands#blueIcon",o=n.match(m)[1];return e[o]=++e[o]||1,e},{}),r=(e=this.getData().properties.geoObjects,0),i=0;for(key in e)e[key].properties.carPresetNotGreen?r++:i++;var s=parseInt(r+i,10),a=parseInt(i,10);t.innerHTML=300<a?"300+":a;var c=this.getParentElement(),l=parseInt(c.style.zIndex,10);c.style.zIndex=l+a,0==a&&(t.style.color="#B3B3B3",c.style.zIndex=l-2);var u=1e3<=s?"large":100<=s?"medium":10<=s?"small":"tiny",h=this._icon=g.icons[u],p=h.size,d=h.offset,f=n.generateIconDataURL(o,e.length);t.style.width=p[0]+"px",t.style.height=p[1]+"px",t.style.left=d[0]+"px",t.style.top=d[1]+"px",t.style.lineHeight=p[1]+"px",t.style.backgroundImage="url("+f+")",t.style.backgroundSize=p[0]+"px "+p[1]+"px"},clear:function(){C.superclass.clear.call(this)},getShape:function(){return this._icon.shape}});e(C)}),t.modules.define("RandomPointsGenerator",["coordSystem.geo"],function(e,a){function t(e){this.count=e||0}t.generate=function(e){return new t(e)},t.prototype.generate=function(e){return this.count=e,this},t.prototype.atBounds=function(e){for(var t=[e[1][0]-e[0][0],e[1][1]-e[0][1]],n=[],o=0;o<this.count;o++)n[o]=this.createPlacemark([Math.random()*t[0]+e[0][0],Math.random()*t[1]+e[0][1]],o);return n},t.prototype.atCenterAndRadius=function(e,t){for(var n=[],o=0;o<this.count;o++){var r=[Math.random()-Math.random(),Math.random()-Math.random()],i=t*Math.random(),s=a.solveDirectProblem(e,r,i).endPoint;n[o]=this.createPlacemark(s,o)}return n},t.prototype.atCenterAndSize=function(){},t.prototype.createPlacemark=function(e,t){return new ymaps.GeoObject({geometry:{type:"Point",coordinates:e},properties:this.getPointData(t)},this.getPointOptions(t))},t.prototype.getPointData=function(){return{}},t.prototype.getPointOptions=function(){return{}},e(t)}),t.modules.define("PieChartClusterer.component.Canvas",["option.Manager","PieChartClusterer.icon.colors"],function(e,t,n){var u="white",h=2,i=23,s="white",o=function(e){this._canvas=document.createElement("canvas"),this._canvas.width=e[0],this._canvas.height=e[1],this._context=this._canvas.getContext("2d"),this.options=new t({})};o.prototype.generateIconDataURL=function(e,t){return this._drawIcon(e,t),this._canvas.toDataURL()},o.prototype._drawIcon=function(t,e){var n=90,o=360,r=this._context,i=this._canvas.width/2,s=this._canvas.height/2,a=this.options.get("canvasIconLineWidth",h),c=this.options.get("canvasIconStrokeStyle",u),l=Math.floor((i+s-a)/2);r.strokeStyle=c,r.lineWidth=a,Object.keys(t).forEach(function(e){2==Object.keys(t).length&&90==n&&(e="gray"),2==Object.keys(t).length&&90!=n&&(e="darkGreen"),r.fillStyle=this._getStyleColor(e),o=n+180,1==Object.keys(t).length?this._drawCircle(i,s,l):(this._drawSector(i,s,l,n,o),n=o)},this),this._drawCore(i,s)},o.prototype._drawCore=function(e,t){var n=this._context,o=this.options.get("canvasIconCoreFillStyle",s),r=this.options.get("canvasIconCoreRadius",i);n.fillStyle=o,this._drawCircle(e,t,r)},o.prototype._drawCircle=function(e,t,n){var o=this._context;o.beginPath(),o.arc(e,t,n,0,2*Math.PI),o.fill(),o.stroke()},o.prototype._drawSector=function(e,t,n,o,r){var i=this._context;return i.beginPath(),i.moveTo(e,t),i.arc(e,t,n,this._toRadians(o),this._toRadians(r)),i.lineTo(e,t),i.closePath(),i.fill(),i.stroke(),r},o.prototype._toRadians=function(e){return e*Math.PI/180},o.prototype._getStyleColor=function(e){return n[e]},e(o)}),t.modules.define("PieChartClusterer.icon.colors",[],function(e){e({blue:"#1E98FF",red:"#ED4543",darkOrange:"#E6761B",night:"#0E4779",darkBlue:"#177BC9",pink:"#F371D1",gray:"#B3B3B3",brown:"#793D0E",darkGreen:"#1BAD03",violet:"#B51EFF",black:"#595959",yellow:"#FFD21E",green:"#56DB40",orange:"#FF931E",lightBlue:"#82CDFF",olive:"#97A100"})}),t.modules.define("PieChartClusterer.icon.params",["shape.Circle","geometry.pixel.Circle"],function(e,t,n){e({icons:{tiny:{size:[35,35],offset:[-17.5,-17.5],shape:new t(new n([0,2],17.5))},small:{size:[46,46],offset:[-23,-23],shape:new t(new n([0,2],21.5))},medium:{size:[58,58],offset:[-29,-29],shape:new t(new n([0,2],27.5))},large:{size:[71,71],offset:[-35.5,-35.5],shape:new t(new n([0,2],34))}},numbers:[10,100]})})}(this);